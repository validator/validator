version: "{build}"

clone_depth: 5

environment:
  matrix:
    - JAVA_HOME: C:\Program Files\Java\jdk1.8.0
    - JAVA_HOME: C:\Program Files\Java\jdk9
    - JAVA_HOME: C:\Program Files\Java\jdk10

install:
  - set PATH=C:\Python35-x64;C:\Python35-x64\Scripts;%JAVA_HOME%\bin;%PATH%
  - java -version
  - python --version
  # Nu Html Checker uses utf-8 for output so change code page here
  - chcp 65001
  - pip install certifi
  - python .\build\build.py update

build_script:
  - python .\build\build.py dldeps
  - python .\build\build.py build

test_script:
  - python .\build\build.py check
  - python .\build\build.py test
  - echo "test" | python .\build\build.py jar
  - java -jar .\build\dist\vnu.jar .\build\dist\index.html
  - java -jar .\build\dist\vnu.jar .\site\nu-about.html
  - echo "test" | python .\build\build.py war

cache:
  # cache the dependencies folder, and invalidate the cache
  # if any of the files right of the arrow change
  - 'dependencies -> .appveyor.yml,build\build.py,build\build.xml'
